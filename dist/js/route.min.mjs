var t=function(t,r,e){if(this.name=t,this.ziggy=e,this.route=this.ziggy.namedRoutes[this.name],void 0===this.name)throw new Error("Ziggy Error: You must provide a route name");if(void 0===this.route)throw new Error("Ziggy Error: route '"+this.name+"' is not found in the route list");this.absolute=void 0===r||r,this.domain=this.setDomain(),this.path=this.route.uri.replace(/^\//,"")};t.prototype.setDomain=function(){if(!this.absolute)return"/";if(!this.route.domain)return this.ziggy.baseUrl.replace(/\/?$/,"/");var t=(this.route.domain||this.ziggy.baseDomain).replace(/\/+$/,"");return this.ziggy.basePort&&t.replace(/\/+$/,"")===this.ziggy.baseDomain.replace(/\/+$/,"")&&(t=this.ziggy.baseDomain+":"+this.ziggy.basePort),this.ziggy.baseProtocol+"://"+t+"/"},t.prototype.construct=function(){return this.domain+this.path};var r=Object.assign||function(t,r){for(var e in r)t[e]=r[e];return t},e=function(e){function i(r,i,n,o){void 0===o&&(o=null),e.call(this),this.name=r,this.absolute=n,this.ziggy=o||Ziggy,this.template=this.name?new t(r,n,this.ziggy).construct():"",this.urlParams=this.normalizeParams(i),this.queryParams=this.normalizeParams(i)}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var n={params:{configurable:!0}};return i.prototype.normalizeParams=function(t){return void 0===t?{}:((t="object"!=typeof t?[t]:t).hasOwnProperty("id")&&-1==this.template.indexOf("{id}")&&(t=[t.id]),this.numericParamIndices=Array.isArray(t),r({},t))},i.prototype.with=function(t){return this.urlParams=this.normalizeParams(t),this},i.prototype.withQuery=function(t){return r(this.queryParams,t),this},i.prototype.hydrateUrl=function(){var t=this,r=this.urlParams,e=0,i=this.template.match(/{([^}]+)}/gi),n=!1;return i&&i.length!=Object.keys(r).length&&(n=!0),this.template.replace(/{([^}]+)}/gi,function(i,o){var a=t.trimParam(i),s=t.numericParamIndices?e:a,u=t.ziggy.defaultParameters[a];if(u&&n&&(t.numericParamIndices?(r=Object.keys(r).map(function(t){return r[t]})).splice(s,0,u):r[s]=u),e++,void 0!==r[s])return delete t.queryParams[s],r[s].id||encodeURIComponent(r[s]);if(-1===i.indexOf("?"))throw new Error("Ziggy Error: '"+a+"' key is required for route '"+t.name+"'");return""})},i.prototype.matchUrl=function(){var t=window.location.hostname+(window.location.port?":"+window.location.port:"")+window.location.pathname,r=this.template.replace(/(\{[^\}]*\})/gi,"[^/?]+").split("://")[1],e=t.replace(/\/?$/,"/");return new RegExp("^"+r+"/$").test(e)},i.prototype.constructQuery=function(){if(0===Object.keys(this.queryParams).length)return"";var t="?";return Object.keys(this.queryParams).forEach(function(r,e){null!=this.queryParams[r]&&(t=0===e?t:t+"&",t+=r+"="+encodeURIComponent(this.queryParams[r]))}.bind(this)),t},i.prototype.current=function(t){var r=this;void 0===t&&(t=null);var e=Object.keys(this.ziggy.namedRoutes).filter(function(t){return-1!==r.ziggy.namedRoutes[t].methods.indexOf("GET")&&new i(t,void 0,void 0,r.ziggy).matchUrl()})[0];return t?new RegExp(t.replace("*",".*").replace(".","."),"i").test(e):e},i.prototype.extractParams=function(t,e,i){var n=this,o=t.split(i);return e.split(i).reduce(function(t,e,i){var a;return 0===e.indexOf("{")&&-1!==e.indexOf("}")&&o[i]?r(t,((a={})[n.trimParam(e)]=o[i],a)):t},{})},n.params.get=function(){var t=this.ziggy.namedRoutes[this.current()];return r(this.extractParams(window.location.hostname,t.domain||"","."),this.extractParams(window.location.pathname.slice(1),t.uri,"/"))},i.prototype.parse=function(){this.return=this.hydrateUrl()+this.constructQuery()},i.prototype.url=function(){return this.parse(),this.return},i.prototype.toString=function(){return this.url()},i.prototype.trimParam=function(t){return t.replace(/{|}|\?/g,"")},i.prototype.valueOf=function(){return this.url()},Object.defineProperties(i.prototype,n),i}(String);export default function(t,r,i,n){return new e(t,r,i,n)}
