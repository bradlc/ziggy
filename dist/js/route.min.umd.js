!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.ziggy=e()}(this,function(){var t=function(t,e,r){if(this.name=t,this.ziggy=r,this.route=this.ziggy.namedRoutes[this.name],void 0===this.name)throw new Error("Ziggy Error: You must provide a route name");if(void 0===this.route)throw new Error("Ziggy Error: route '"+this.name+"' is not found in the route list");this.absolute=void 0===e||e,this.domain=this.setDomain(),this.path=this.route.uri.replace(/^\//,"")};t.prototype.setDomain=function(){if(!this.absolute)return"/";if(!this.route.domain)return this.ziggy.baseUrl.replace(/\/?$/,"/");var t=(this.route.domain||this.ziggy.baseDomain).replace(/\/+$/,"");return this.ziggy.basePort&&t.replace(/\/+$/,"")===this.ziggy.baseDomain.replace(/\/+$/,"")&&(t=this.ziggy.baseDomain+":"+this.ziggy.basePort),this.ziggy.baseProtocol+"://"+t+"/"},t.prototype.construct=function(){return this.domain+this.path};var e=Object.assign||function(t,e){for(var r in e)t[r]=e[r];return t},r=function(r){function i(e,i,n,o){void 0===o&&(o=null),r.call(this),this.name=e,this.absolute=n,this.ziggy=o||Ziggy,this.template=this.name?new t(e,n,this.ziggy).construct():"",this.urlParams=this.normalizeParams(i),this.queryParams=this.normalizeParams(i)}return r&&(i.__proto__=r),(i.prototype=Object.create(r&&r.prototype)).constructor=i,i.prototype.normalizeParams=function(t){return void 0===t?{}:((t="object"!=typeof t?[t]:t).hasOwnProperty("id")&&-1==this.template.indexOf("{id}")&&(t=[t.id]),this.numericParamIndices=Array.isArray(t),e({},t))},i.prototype.with=function(t){return this.urlParams=this.normalizeParams(t),this},i.prototype.withQuery=function(t){return e(this.queryParams,t),this},i.prototype.hydrateUrl=function(){var t=this,e=this.urlParams,r=0,i=this.template.match(/{([^}]+)}/gi),n=!1;return i&&i.length!=Object.keys(e).length&&(n=!0),this.template.replace(/{([^}]+)}/gi,function(i,o){var a=i.replace(/\{|\}/gi,"").replace(/\?$/,""),s=t.numericParamIndices?r:a,u=t.ziggy.defaultParameters[a];if(u&&n&&(t.numericParamIndices?(e=Object.keys(e).map(function(t){return e[t]})).splice(s,0,u):e[s]=u),r++,void 0!==e[s])return delete t.queryParams[s],e[s].id||encodeURIComponent(e[s]);if(-1===i.indexOf("?"))throw new Error("Ziggy Error: '"+a+"' key is required for route '"+t.name+"'");return""})},i.prototype.matchUrl=function(){var t=window.location.hostname+(window.location.port?":"+window.location.port:"")+window.location.pathname,e=this.template.replace(/(\{[^\}]*\})/gi,"[^/?]+").split("://")[1],r=t.replace(/\/?$/,"/");return new RegExp("^"+e+"/$").test(r)},i.prototype.constructQuery=function(){if(0===Object.keys(this.queryParams).length)return"";var t="?";return Object.keys(this.queryParams).forEach(function(e,r){null!=this.queryParams[e]&&(t=0===r?t:t+"&",t+=e+"="+encodeURIComponent(this.queryParams[e]))}.bind(this)),t},i.prototype.current=function(t){var e=this;void 0===t&&(t=null);var r=Object.keys(this.ziggy.namedRoutes).filter(function(t){return-1!==e.ziggy.namedRoutes[t].methods.indexOf("GET")&&new i(t,void 0,void 0,e.ziggy).matchUrl()})[0];return t?t==r:r},i.prototype.parse=function(){this.return=this.hydrateUrl()+this.constructQuery()},i.prototype.url=function(){return this.parse(),this.return},i.prototype.toString=function(){return this.url()},i.prototype.valueOf=function(){return this.url()},i}(String);return function(t,e,i,n){return new r(t,e,i,n)}});
